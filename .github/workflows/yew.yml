  name: Build and Deploy
   on:
     push:
       branches: [ main ]
     pull_request:
       branches: [ main ]
     workflow_dispatch:
    
   jobs:
     build_and_deploy:
       runs-on: ubuntu-latest
       steps:
         - name: Checkout 🛎️
           uses: actions/checkout@v2.3.1
           with:
             persist-credentials: false

         - name: Install Rust 🦀
           uses: actions-rs/toolchain@v1
           with:
             toolchain: stable
             override: true
             components: rustfmt, clippy

         - name: Install Trunk 🧳
           run: |
             curl -Ls https://github.com/thedodd/trunk/releases/latest/download/trunk-x86_64-unknown-linux-gnu.tar.gz \
             | tar xz --strip-components 1 -C ~/.cargo/bin

         - name: Build with Trunk 🏗️
           run: |
             trunk build --release

         - name: Deploy to Github Pages 🚀
           uses: JamesIves/github-pages-deploy-action@4.1.1
           with:
             branch: gh-pages
             folder: dist
